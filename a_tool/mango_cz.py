import pymongo
import json


#  对mango数据中text中的a2表进行去重
def de_weigh_json():
    """ 对mango数据中text中的a2表进行去重"""
    client = pymongo.MongoClient("localhost", 27017)
    db = client['text']
    collection = db['a2']
    pipeline = [
        {
            "$sort": {"_id": -1}  # 按 _id 降序排序，假设 _id 是递增的或时间戳
        },
        {
            "$group": {
                "_id": {"$ifNull": ["$qa_biz_params.item_id", "$rich_text", "ocr_text", "analysis"]},
                # 如果 item_id 不存在，则用 rich_text 替代
                "latestDocument": {"$first": "$$ROOT"}  # 选取每个 item_id 对应的最新文档
            }
        },
        {
            "$replaceRoot": {"newRoot": "$latestDocument"}  # 以最新文档作为根
        }
    ]

    # 获取每个 item_id 的唯一文档

    unique_documents = list(collection.aggregate(pipeline))

    # Step 2: 获取每个 item_id 的最新文档的 _id
    latest_ids = {doc['_id'] for doc in unique_documents}

    # Step 3: 删除其他重复的文档
    result = collection.delete_many({
        "_id": {"$nin": list(latest_ids)}  # 删除 _id 不在最新文档中的文档
    })
    print("重复文档已删除，只保留最新的文档", end="\t----")
    print(f"删除了 {result.deleted_count} 个文档")


def add_mango():
    """ 对mango数据中text中的a2表数据 写入"""
    client = pymongo.MongoClient("localhost", 27017)

    db = client['text']
    collection = db['a2']
    json_list = [
        "{\"biz_app_id\":520947,\"biz_scenes\":6,\"qa_biz_params\":{\"search_id\":1821746581790976,\"res_id\":1821746588933164,\"item_id\":1401058445,\"department\":1,\"subject\":2,\"qa_item_result\":{\"search_id\":1821746581790976,\"res_id\":1821746588933164,\"item_id\":1401058445,\"rich_text\":\"一、我会填\\n1. \\n![img](https://p6-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/aefbb5aec48b4a75a890a78fd4ad0bc4~tplv-ii0cwwkcx9-resize-crop-v1:93:154:222:187:0:0.jpeg?lk3s=f89d68d8\\u0026x-expires=2052712951\\u0026x-signature=1zMEhTdXFLVovGKlCrPUOWUPy6Y%3D)\\n \\n![img](https://p9-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/aefbb5aec48b4a75a890a78fd4ad0bc4~tplv-ii0cwwkcx9-resize-crop-v1:95:206:222:240:0:0.jpeg?lk3s=f89d68d8\\u0026x-expires=2052712951\\u0026x-signature=iwe%2FYNuowaZJ9iZSvPWM84YWUzc%3D)\\n![img](https://p3-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/aefbb5aec48b4a75a890a78fd4ad0bc4~tplv-ii0cwwkcx9-resize-crop-v1:257:204:387:238:0:0.jpeg?lk3s=f89d68d8\\u0026x-expires=2052712951\\u0026x-signature=BCrgB6lPF%2BTgsB88xAPvA2yQqSU%3D)\\n \\n![img](https://p3-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/aefbb5aec48b4a75a890a78fd4ad0bc4~tplv-ii0cwwkcx9-resize-crop-v1:98:315:129:346:0:0.jpeg?lk3s=f89d68d8\\u0026x-expires=2052712951\\u0026x-signature=HFGHirOLrz5W6zzrt9Uh5r%2FtjG8%3D)\\n的个数是 的( \\n![img](https://p3-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/aefbb5aec48b4a75a890a78fd4ad0bc4~tplv-ii0cwwkcx9-resize-crop-v1:260:314:291:343:0:0.jpeg?lk3s=f89d68d8\\u0026x-expires=2052712951\\u0026x-signature=KH3fNKZJ9huqoGdgDR9V6DUvoOY%3D)\\n)倍， \\n![img](https://p9-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/aefbb5aec48b4a75a890a78fd4ad0bc4~tplv-ii0cwwkcx9-resize-crop-v1:99:369:130:400:0:0.jpeg?lk3s=f89d68d8\\u0026x-expires=2052712951\\u0026x-signature=4mGnuxk503ME13YsPqg%2F139%2FvKk%3D)\\n的个数是 的( \\n![img](https://p9-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/aefbb5aec48b4a75a890a78fd4ad0bc4~tplv-ii0cwwkcx9-resize-crop-v1:261:368:293:397:0:0.jpeg?lk3s=f89d68d8\\u0026x-expires=2052712951\\u0026x-signature=99MGM69gdCwTuZLwDyZWHXDxLi8%3D)\\n)倍。\",\"ocr_text\":\"1. △△△△△△ 的个数是〇的( )倍,☆的个数是△的( )倍。\",\"answer\":\"【解析】【答案】 2 , 3 【解析】 \\n![img](https://p6-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/a851a321e76d448892b28022d97e40ee~tplv-ii0cwwkcx9-resize-crop-v1:48:183:208:215:0:0.jpeg?lk3s=f89d68d8\\u0026x-expires=2052712951\\u0026x-signature=eeXO14asRGz6x0VBFPpC%2FbPLTWc%3D)\\n \\n![img](https://p3-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/a851a321e76d448892b28022d97e40ee~tplv-ii0cwwkcx9-resize-crop-v1:249:226:409:301:0:0.jpeg?lk3s=f89d68d8\\u0026x-expires=2052712951\\u0026x-signature=7wEuAC3sLh%2BRthSTIysKAdzfYvQ%3D)\\n![img](https://p9-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/a851a321e76d448892b28022d97e40ee~tplv-ii0cwwkcx9-resize-crop-v1:454:269:609:299:0:0.jpeg?lk3s=f89d68d8\\u0026x-expires=2052712951\\u0026x-signature=fgIYVGFkwcb2beYPvOpr0WFmzMw%3D)\\n 的个数是 的( 2 )倍 \\n![img](https://p3-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/a851a321e76d448892b28022d97e40ee~tplv-ii0cwwkcx9-resize-crop-v1:253:320:292:346:0:0.jpeg?lk3s=f89d68d8\\u0026x-expires=2052712951\\u0026x-signature=ho6T7%2BHGRdw0zH7p1f8QsHI8YpY%3D)\\n \\n![img](https://p6-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/a851a321e76d448892b28022d97e40ee~tplv-ii0cwwkcx9-resize-crop-v1:55:367:93:395:0:0.jpeg?lk3s=f89d68d8\\u0026x-expires=2052712951\\u0026x-signature=cFMA%2B4AedtksHnmpJXoPjUJa0jo%3D)\\n的个数是 的(3 )倍。 \\n![img](https://p3-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/a851a321e76d448892b28022d97e40ee~tplv-ii0cwwkcx9-resize-crop-v1:254:365:292:391:0:0.jpeg?lk3s=f89d68d8\\u0026x-expires=2052712951\\u0026x-signature=Qhq7R88%2FXGa8KxZETh7gvdl1Wb0%3D)\\n 故答案为：2，3\",\"is_origin\":true,\"can_llm_solved\":false,\"markdown_gray_publish\":true,\"has_hint\":true,\"detection_type\":2,\"search_type\":1,\"analysis\":\"## 分析\\n我们要理解\\u003cwiki wiki_id=6806545505154363987 search_id=1821746588933164\\u003e倍数\\u003c/wiki\\u003e的概念，倍数就是一个数里面包含几个另一个数。那我们就可以通过\\u003cwiki wiki_id=5653255506772513363 search_id=1821746588933164\\u003e数一数\\u003c/wiki\\u003e两种图形的个数，然后用多的图形个数除以少的图形个数，得到的就是\\u003cwiki wiki_id=8535897573364019795 search_id=1821746588933164\\u003e倍数关系\\u003c/wiki\\u003e。\\n## 详解\\n1. **求第一个倍数关系**\\n    - 我们先数一下两种图形的个数，通过观察图片可知，前面一种图形有\\\\(4\\\\)个，后面一种图形有\\\\(2\\\\)个。\\n    - 要求前面图形的个数是后面图形个数的\\u003cwiki wiki_id=8535491724938261075 search_id=1821746588933164\\u003e几倍\\u003c/wiki\\u003e，就是看\\\\(4\\\\)里面有几个\\\\(2\\\\)，用\\u003cwiki wiki_id=1041624824303661651 search_id=1821746588933164\\u003e除法\\u003c/wiki\\u003e计算，即\\\\(4\\\\div2 = 2\\\\)。\\n2. **求第二个倍数关系**\\n    - 再数另外两种图形的个数，一种图形有\\\\(6\\\\)个，另一种图形有\\\\(2\\\\)个。\\n    - 求前面图形的个数是后面图形个数的几倍，就是求\\\\(6\\\\)里面有几个\\\\(2\\\\)，用除法计算，\\\\(6\\\\div2 = 3\\\\)。\\n## 总结\\n所以这道题的答案是\\\\(2\\\\)，\\\\(3\\\\)。\"},\"entrance_type\":8}}",
        "{\"biz_app_id\":520947,\"biz_scenes\":6,\"qa_biz_params\":{\"search_id\":1821746588932140,\"res_id\":1821746597342283,\"item_id\":655609361,\"department\":1,\"subject\":2,\"qa_item_result\":{\"search_id\":1821746588932140,\"res_id\":1821746597342283,\"item_id\":655609361,\"rich_text\":\"7.小丽有 36 元,小明有 9 元,小丽的钱数是小明的( )倍,小强的钱数是小明的6倍,小强有( )元。\",\"ocr_text\":\"5.小丽有36元,小明有9元,小丽的钱数是小明的()倍,小强的钱数是小明的6倍,小强有()元。\",\"answer\":\"4 54\",\"is_origin\":true,\"can_llm_solved\":false,\"markdown_gray_publish\":true,\"has_hint\":true,\"detection_type\":2,\"search_type\":1,\"analysis\":\"## 分析\\n先计算小丽的钱数是小明的\\u003cwiki wiki_id=8535491724938261075 search_id=1821746597342283\\u003e几倍\\u003c/wiki\\u003e，再计算小强的钱数。\\n## 详解\\n1. **求小丽的钱数是小明的几倍**\\n因为要知道小丽的钱数是小明的多少倍，所以用小丽的钱数除以小明的钱数，即\\\\(36÷9=4\\\\)，这就得出小丽的钱数是小明的\\\\(4\\\\)倍。\\n2. **求小强的钱数**\\n因为小强的钱数是小明的\\\\(6\\\\)倍，所以用小明的钱数乘\\\\(6\\\\)，即\\\\(9×6=54\\\\)（元），这就得出小强有\\\\(54\\\\)元。\\n## 总结\\n故本题的答案是：小丽的钱数是小明的\\\\(4\\\\)倍，小强有\\\\(54\\\\)元。\",\"has_guide_qa_entrance\":true},\"entrance_type\":8}}",
        "{\"biz_app_id\":520947,\"biz_scenes\":6,\"qa_biz_params\":{\"search_id\":1821746613992532,\"res_id\":1821746613993492,\"item_id\":1624807422,\"department\":1,\"subject\":2,\"qa_item_result\":{\"search_id\":1821746613992532,\"res_id\":1821746613993492,\"item_id\":1624807422,\"rich_text\":\"参加3 项体育活动的一共有多少人？ \\n游泳跳高跑步 28人 13人 59人\",\"ocr_text\":\"1.参加3项体育活动的一共有多少人？ \\n游泳跳高跑步 28人 13人 59人\",\"answer\":\"\",\"is_origin\":true,\"can_llm_solved\":false,\"markdown_gray_publish\":true,\"has_hint\":true,\"detection_type\":2,\"search_type\":1,\"analysis\":\"## 分析\\n将参加游泳、跳高、跑步这三项体育活动的人数相加，即可得到总人数。\\n## 详解\\n1. **计算总人数**\\n参加游泳的有 \\\\(28\\\\) 人，参加跳高的有 \\\\(13\\\\) 人，参加跑步的有 \\\\(59\\\\) 人。\\n总人数为 \\\\(28 + 13 + 59\\\\)\\n\\\\[\\n\\\\begin{align*}\\n\\u002628 + 13 + 59\\\\\\\\\\n=\\u002641 + 59\\\\\\\\\\n=\\u0026100\\n\\\\end{align*}\\n\\\\]\\n## 总结\\n参加 3 项体育活动的一共有 \\\\(100\\\\) 人。\",\"has_guide_qa_entrance\":true},\"entrance_type\":8}}",
        "{\"biz_app_id\":520947,\"biz_scenes\":6,\"qa_biz_params\":{\"search_id\":1821746588932124,\"res_id\":1821746588934236,\"item_id\":661821968,\"department\":1,\"subject\":2,\"qa_item_result\":{\"search_id\":1821746588932124,\"res_id\":1821746588934236,\"item_id\":661821968,\"rich_text\":\"\\u003cimg src=\\\"https://qb-oss.bytededu.cn/snapshot/4b8709d8f8d1926878d837ef09a772bb-375.png\\\" width=\\\"335\\\" height=\\\"54\\\" style=\\\"width: 335px; height: 54px;\\\"/\\u003e\",\"ocr_text\":\"4.○○○○○○○○○○□□□□去掉()个〇，〇的个数就是□的2倍。增加()个□,○的个数就是□的2倍。\",\"answer\":\"2 ; 1\",\"is_origin\":true,\"can_llm_solved\":false,\"markdown_gray_publish\":true,\"has_hint\":true,\"detection_type\":2,\"search_type\":1,\"analysis\":\"## 分析\\n这是一道“\\u003cwiki wiki_id=8535897573364019795 search_id=1821746588934236\\u003e倍数关系\\u003c/wiki\\u003e的数量调整问题”。需要先数出两种图形的个数，再根据\\u003cwiki wiki_id=6806545505154363987 search_id=1821746588934236\\u003e倍数\\u003c/wiki\\u003e关系计算出需要调整的数量。\\n\\n## 详解\\n1. **数出两种图形的个数**：\\n通过观察图片，数出\\\\(○\\\\)的个数是\\\\(10\\\\)个，\\\\(□\\\\)的个数是\\\\(4\\\\)个。\\n2. **计算去掉\\\\(○\\\\)的个数**：\\n因为要使\\\\(○\\\\)的个数是\\\\(□\\\\)的\\\\(2\\\\)倍，\\\\(□\\\\)有\\\\(4\\\\)个，那么\\\\(○\\\\)应该有\\\\(4\\\\times2 = 8\\\\)个。现在\\\\(○\\\\)有\\\\(10\\\\)个，所以要去掉的\\\\(○\\\\)的个数为\\\\(10 - 8=2\\\\)个。\\n3. **计算增加\\\\(□\\\\)的个数**：\\n要使\\\\(○\\\\)的个数是\\\\(□\\\\)的\\\\(2\\\\)倍，\\\\(○\\\\)有\\\\(10\\\\)个，那么\\\\(□\\\\)应该有\\\\(10\\\\div2 = 5\\\\)个。现在\\\\(□\\\\)有\\\\(4\\\\)个，所以要增加的\\\\(□\\\\)的个数为\\\\(5 - 4 = 1\\\\)个。\\n\\n## 总结\\n答案为去掉\\\\(2\\\\)个\\\\(○\\\\)，增加\\\\(1\\\\)个\\\\(□\\\\)。\"},\"entrance_type\":8}}",
        "{\"biz_app_id\":520947,\"biz_scenes\":6,\"qa_biz_params\":{\"search_id\":1821746609259540,\"res_id\":1821746609261572,\"item_id\":189428268,\"department\":1,\"subject\":2,\"qa_item_result\":{\"search_id\":1821746609259540,\"res_id\":1821746609261572,\"item_id\":189428268,\"rich_text\":\"\\u003cimg src=\\\"https://qb-oss.bytededu.cn/snapshot/ad88313405e62b384bb67f8c3bcc4cb5-375.png\\\" width=\\\"335\\\" height=\\\"173\\\" style=\\\"width: 335px; height: 173px;\\\"/\\u003e\",\"ocr_text\":\"① ② ③ ④ ⑤ ⑥ ⑦ ⑧ ⑨ ⑩ \\n长方形的有（ ）；正方体的有（ ）； 三角形的有（ ）；平行四边形的有（ ）; \\n圆形的有（ ）。\",\"answer\":\"⑤⑪ ①⑩ ③⑧ ④⑥ ②\",\"is_origin\":true,\"can_llm_solved\":false,\"markdown_gray_publish\":true,\"has_hint\":true,\"detection_type\":2,\"search_type\":1,\"analysis\":\"## 分析\\n我们要根据\\u003cwiki wiki_id=5941708964288935507 search_id=1821746609261572\\u003e正方形\\u003c/wiki\\u003e、\\u003cwiki wiki_id=5653268480541536851 search_id=1821746609261572\\u003e长方形\\u003c/wiki\\u003e、\\u003cwiki wiki_id=7959145892214518355 search_id=1821746609261572\\u003e平行四边形\\u003c/wiki\\u003e、\\u003cwiki wiki_id=3347442290586036819 search_id=1821746609261572\\u003e三角形\\u003c/wiki\\u003e和圆形的形状特点来进行判断。正方形是四条边都相等，四个角都是\\u003cwiki wiki_id=3347521136325571155 search_id=1821746609261572\\u003e直角\\u003c/wiki\\u003e的图形；长方形是四个角为直角的\\u003cwiki wiki_id=1041916875557515859 search_id=1821746609261572\\u003e四边形\\u003c/wiki\\u003e，对边相等；\\u003cwiki wiki_id=5941479963017917011 search_id=1821746609261572\\u003e平行\\u003c/wiki\\u003e四边形是对边平行且相等的四边形；三角形是由三条\\u003cwiki wiki_id=1041848932006670931 search_id=1821746609261572\\u003e线段\\u003c/wiki\\u003e首尾相连围成的图形；圆形是一个曲线围成的封闭图形。然后我们依次观察给出的图形，找出符合各种图形特点的序号填到括号里。\\n## 详解\\n1. **找正方形**\\n   - 我们观察这些图形，正方形的四条边都相等，四个角都是直角。\\n   - 看到图形⑤和⑪，它们的四条边相等，四个角都是直角，所以正方形有⑤⑪。\\n2. **找长方形**\\n   - 长方形四个角是直角，对边相等。\\n   - 图形①和⑩符合这个特点，所以长方形有①⑩。\\n3. **找平行四边形**\\n   - 平行四边形对边平行且相等。\\n   - 图形③和⑧符合这个特点，所以平行四边形有③⑧。\\n4. **找三角形**\\n   - 三角形是由三条线段首尾相连围成的图形。\\n   - 图形④和⑥符合这个特点，所以三角形有④⑥。\\n5. **找圆形**\\n   - 圆形是一个曲线围成的封闭图形。\\n   - 图形②符合这个特点，所以圆形有②。\\n## 总结\\n故本题的答案是：正方形有⑤⑪；长方形有①⑩；平行四边形有③⑧；三角形有④⑥；圆形有②。\"},\"entrance_type\":8}}",
        "{\"biz_app_id\":520947,\"biz_scenes\":6,\"qa_biz_params\":{\"search_id\":1821746613993476,\"res_id\":1821746613994692,\"item_id\":1623962982,\"department\":1,\"subject\":2,\"qa_item_result\":{\"search_id\":1821746613993476,\"res_id\":1821746613994692,\"item_id\":1623962982,\"rich_text\":\"一本故事书 80 页,小明第一天看了 24 页,第二天比第一天多看 18 页,小明一共看了多少页?\",\"ocr_text\":\"4. 一本故事书 80 页,小明第一天看了 24页，第二天比第一天多看 18 页,小明一共看了多少页?\",\"answer\":\"66 页\",\"is_origin\":true,\"can_llm_solved\":false,\"markdown_gray_publish\":true,\"has_hint\":true,\"detection_type\":2,\"search_type\":1,\"analysis\":\"## 分析\\n这是一道加法应用题。解题思路是先求出第二天看的页数，再将第一天和第二天看的页数相加，得到总共看的页数。\\n\\n## 详解\\n1. **计算第二天看的页数**：\\n已知小明第一天看了\\\\(24\\\\)页，第二天比第一天多看\\\\(18\\\\)页，那么第二天看的页数为第一天看的页数加上\\\\(18\\\\)页，即：\\n\\\\[24 + 18 = 42~(\\\\text{页})\\\\]\\n2. **计算小明一共看的页数**：\\n第一天看了\\\\(24\\\\)页，第二天看了\\\\(42\\\\)页，那么小明一共看的页数为第一天看的页数加上第二天看的页数，即：\\n\\\\[24+42 = 66~(\\\\text{页})\\\\]\\n\\n## 总结\\n小明一共看了\\\\(66\\\\)页。\",\"has_guide_qa_entrance\":true},\"entrance_type\":8}}",
        "{\"biz_app_id\":520947,\"biz_scenes\":6,\"qa_biz_params\":{\"search_id\":1821746581790992,\"res_id\":1821746588933180,\"item_id\":159952829,\"department\":1,\"subject\":2,\"qa_item_result\":{\"search_id\":1821746581790992,\"res_id\":1821746588933180,\"item_id\":159952829,\"rich_text\":\"7 的( )倍是 42,63 是 9 的( )倍。\",\"ocr_text\":\"2.7的()倍是42,63是9的()倍,8的6倍是()。\",\"answer\":\"(1) 6 (2) 7\",\"is_origin\":true,\"can_llm_solved\":true,\"markdown_gray_publish\":true,\"has_hint\":true,\"detection_type\":2,\"search_type\":1,\"analysis\":\"## 分析\\n对于这两个问题，都是利用\\u003cwiki wiki_id=1041624824303661651 search_id=1821746588933180\\u003e除法\\u003c/wiki\\u003e运算来求解。求\\u003cwiki wiki_id=8535897573364019795 search_id=1821746588933180\\u003e一个数是另一个数的几倍\\u003c/wiki\\u003e或者\\u003cwiki wiki_id=3347852268607015507 search_id=1821746588933180\\u003e一个数的几倍\\u003c/wiki\\u003e是另一个数，都要用除法，即用较大的数除以较小的数。\\n## 详解\\n1. **求7的\\u003cwiki wiki_id=8535491724938261075 search_id=1821746588933180\\u003e几倍\\u003c/wiki\\u003e是42**\\n我们知道，在\\u003cwiki wiki_id=6806545505154363987 search_id=1821746588933180\\u003e倍数\\u003c/wiki\\u003e问题中，如果想知道7的几倍是42，就需要用42来除以7。因为\\u003cwiki wiki_id=2771394602897880915 search_id=1821746588933180\\u003e除法的意义\\u003c/wiki\\u003e就是\\u003cwiki wiki_id=3347375591855305299 search_id=1821746588933180\\u003e平均分\\u003c/wiki\\u003e，在这里就是把42\\u003cwiki wiki_id=6806422424906115667 search_id=1821746588933180\\u003e平均\\u003c/wiki\\u003e分成7份，每份就是所求的倍数。\\\\[42\\\\div7 = 6\\\\]，所以7的6倍是42。\\n2. **求63是9的几倍**\\n同样的道理，求63是9的几倍，也是用除法。把63按照每9个一份来分，能分成几份就是几倍。\\\\[63\\\\div9 = 7\\\\]，所以63是9的7倍。\\n## 总结\\n故本题的答案是：\\n(1) 7的6倍是42；\\n(2) 63是9的7倍。\",\"has_guide_qa_entrance\":true},\"entrance_type\":8}}",
        "{\"biz_app_id\":520947,\"biz_scenes\":6,\"qa_biz_params\":{\"search_id\":1821746613992548,\"res_id\":1821746613993508,\"item_id\":1628720380,\"department\":1,\"subject\":2,\"qa_item_result\":{\"search_id\":1821746613992548,\"res_id\":1821746613993508,\"item_id\":1628720380,\"rich_text\":\"\\u003cimg src=\\\"https://qb-oss.bytededu.cn/snapshot/dc8b5d345b2f5c84bd7fe2abd1371934-375.png\\\" width=\\\"335\\\" height=\\\"154\\\" style=\\\"width: 335px; height: 154px;\\\"/\\u003e\",\"ocr_text\":\"2. 我们年级一共有多少名少先队员？ 我们年级第一最后一批有批有23人入队。 第二批有18人。 16人入队。\",\"answer\":\"$23+18+16=57$（名） \\n答：我们年级一共有 57 名少先队员。\",\"is_origin\":true,\"can_llm_solved\":false,\"markdown_gray_publish\":true,\"has_hint\":true,\"detection_type\":2,\"search_type\":1},\"entrance_type\":8}}",
        "{\"biz_app_id\":520947,\"biz_scenes\":6,\"qa_biz_params\":{\"search_id\":1821746588932108,\"res_id\":1821746588934220,\"item_id\":159952954,\"department\":1,\"subject\":2,\"qa_item_result\":{\"search_id\":1821746588932108,\"res_id\":1821746588934220,\"item_id\":159952954,\"rich_text\":\"4 只手有( )根手指;( )只蜘蛛有 32 条腿。(每只蜘蛛有 8 条腿）\",\"ocr_text\":\"3.4只手有()根手指,()只蜘蛛有32条腿(每只蜘蛛有8条腿)。\",\"answer\":\"20 4\",\"is_origin\":true,\"can_llm_solved\":true,\"markdown_gray_publish\":true,\"has_hint\":true,\"detection_type\":2,\"search_type\":1,\"analysis\":\"## 分析\\n这是两道简单的\\u003cwiki wiki_id=3347661258693587539 search_id=1821746588934220\\u003e乘除法\\u003c/wiki\\u003e应用题。第一道题需要用到\\u003cwiki wiki_id=3347847730640466515 search_id=1821746588934220\\u003e乘法\\u003c/wiki\\u003e运算的概念，即求几个相同加数的和；第二道题需要用到\\u003cwiki wiki_id=1041624824303661651 search_id=1821746588934220\\u003e除法\\u003c/wiki\\u003e运算的概念，即求总数里包含几个每份数。\\n\\n## 详解\\n1. **计算4只手的手指数量**：\\n已知一只手有\\\\(5\\\\)根手指，求\\\\(4\\\\)只手有多少根手指，就是求\\\\(4\\\\)个\\\\(5\\\\)是多少，用乘法计算：\\n\\\\[4\\\\times5 = 20~(\\\\text{根})\\\\]\\n2. **计算有32条腿是几只蜘蛛的**：\\n已知每只蜘蛛有\\\\(8\\\\)条腿，求有\\\\(32\\\\)条腿是几只蜘蛛，就是求\\\\(32\\\\)里面有几个\\\\(8\\\\)，用除法计算：\\n\\\\[32\\\\div8 = 4~(\\\\text{只})\\\\]\\n\\n## 总结\\n4只手有\\\\(20\\\\)根手指；\\\\(4\\\\)只蜘蛛有\\\\(32\\\\)条腿。\",\"has_guide_qa_entrance\":true},\"entrance_type\":8}}",
        "{\"biz_app_id\":520947,\"biz_scenes\":6,\"qa_biz_params\":{\"search_id\":1821746609259572,\"res_id\":1821746609261604,\"item_id\":151434685,\"department\":1,\"subject\":2,\"qa_item_result\":{\"search_id\":1821746609259572,\"res_id\":1821746609261604,\"item_id\":151434685,\"rich_text\":\"\\u003cimg src=\\\"https://qb-oss.bytededu.cn/snapshot/23f25ddce7efcc06ec909ffea9c0b27b-375.png\\\" width=\\\"335\\\" height=\\\"179\\\" style=\\\"width: 335px; height: 179px;\\\"/\\u003e\",\"ocr_text\":\"1. 把下列图中的正方形涂上蓝色，长方形涂上红色。\",\"answer\":\"根据题的描述找打图形并图上颜色，让学生认识图形。\",\"is_origin\":true,\"can_llm_solved\":false,\"markdown_gray_publish\":true,\"has_hint\":true,\"detection_type\":2,\"search_type\":1,\"analysis\":\"## 分析\\n我们要先认识\\u003cwiki wiki_id=5941708964288935507 search_id=1821746609261604\\u003e正方形\\u003c/wiki\\u003e和\\u003cwiki wiki_id=5653268480541536851 search_id=1821746609261604\\u003e长方形\\u003c/wiki\\u003e的样子，正方形四条边一样长，长方形相对的两条长边一样长，相对的两条短边一样长。然后在这些图形中找到正方形涂蓝色，长方形涂红色。\\n## 详解\\n1. **观察第一个图形**\\n仔细看这个图形，它的四条边长度相等，是正方形，我们给它涂上蓝色。\\n2. **观察第二个图形**\\n这个图形相对的两条长边长度相等，相对的两条短边长度相等，是长方形，我们给它涂上红色。\\n3. **观察第三个图形**\\n它的四条边长度相等，是正方形，涂上蓝色。\\n4. **观察第四个图形**\\n这是一个长方形，相对的两条长边一样长，相对的两条短边一样长，涂上红色。\\n5. **观察第五个图形**\\n是长方形，涂上红色。\\n6. **观察第六个图形**\\n是长方形，涂上红色。\\n7. **观察第七个图形**\\n是正方形，涂上蓝色。\\n## 总结\\n根据题目的描述，我们成功地给正方形涂上了蓝色，给长方形涂上了红色，让我们更好地认识了这两种图形。\"},\"entrance_type\":8}}",
        "{\"biz_app_id\":520947,\"biz_scenes\":6,\"qa_biz_params\":{\"search_id\":1821746609259556,\"res_id\":1821746609261588,\"item_id\":650331498,\"department\":1,\"subject\":2,\"qa_item_result\":{\"search_id\":1821746609259556,\"res_id\":1821746609261588,\"item_id\":650331498,\"rich_text\":\"圈一圈。（用右边的哪个物体可以画出左边的图形? ) \\n![img](https://p9-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/6e0f7f2a4f5a40f0bab516ada0a81894~tplv-ii0cwwkcx9-resize-crop-v1:7:106:575:500:0:0.jpeg?lk3s=f89d68d8\\u0026x-expires=2052712965\\u0026x-signature=9j5MjWn0Rrghy5Npy%2Bkn9K6JlMU%3D)\",\"ocr_text\":\"五、圈一圈。（用右边的哪个物体可以画出左边的图形？） ① ② ③ ① ② ③ ① ② ③ ① ② ③\",\"answer\":\"【答案】 \\n![img](https://p6-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/91fcb2010b4f4c7a88a4a69154d633fd~tplv-ii0cwwkcx9-resize-crop-v1:13:58:632:493:0:0.jpeg?lk3s=f89d68d8\\u0026x-expires=2052712965\\u0026x-signature=eyP9SF1iNWjtlwUQy%2BskUShbh0k%3D)\",\"is_origin\":true,\"can_llm_solved\":false,\"markdown_gray_publish\":true,\"has_hint\":true,\"detection_type\":2,\"search_type\":1,\"analysis\":\"## 分析\\n观察左边图形的形状特征，然后对比右边的物体，判断哪个物体的某个面与左边图形形状相同，从而得出答案。\\n\\n## 详解\\n1. **观察左边第一个图形**\\n   - 这个图形是一个圆形。\\n   - 我们看右边的物体，\\u003cwiki wiki_id=3347600136717070931 search_id=1821746609261588\\u003e长方体\\u003c/wiki\\u003e各个面是\\u003cwiki wiki_id=5653268480541536851 search_id=1821746609261588\\u003e长方形\\u003c/wiki\\u003e，三棱柱的面是\\u003cwiki wiki_id=3347442290586036819 search_id=1821746609261588\\u003e三角形\\u003c/wiki\\u003e和长方形，而\\u003cwiki wiki_id=5941871491563465299 search_id=1821746609261588\\u003e圆柱\\u003c/wiki\\u003e的底面是圆形。所以能画出这个圆形的物体是圆柱。\\n2. **观察左边第二个图形**\\n   - 这个图形是一个长方形。\\n   - 长方体有长方形的面，三棱柱有长方形的面，\\u003cwiki wiki_id=2771360590280899411 search_id=1821746609261588\\u003e圆柱的侧面展开\\u003c/wiki\\u003e是长方形。这里需要看图形的长宽比例等细节。长方体的面大小、比例符合这个长方形的形状特征，三棱柱的长方形面可能与这个图形在尺寸比例上不相符，圆柱侧面展开虽然是长方形但一般尺寸比例与这个长方形不同。所以能画出这个长方形的物体是长方体。\\n3. **观察左边第三个图形**\\n   - 这个图形是一个三角形。\\n   - 在右边的物体中，长方体没有三角形的面，圆柱也没有三角形的面，而三棱柱有三角形的面。所以能画出这个三角形的物体是三棱柱。\\n\\n## 总结\\n能画出左边图形的物体依次是圆柱、长方体、三棱柱。\"},\"entrance_type\":8}}",
        "{\"biz_app_id\":520947,\"biz_scenes\":6,\"qa_biz_params\":{\"search_id\":1821746588933132,\"res_id\":1821746597342315,\"item_id\":723805996,\"department\":1,\"subject\":2,\"qa_item_result\":{\"search_id\":1821746588933132,\"res_id\":1821746597342315,\"item_id\":723805996,\"rich_text\":\"皮影戏是我国民间古老的传统艺术,在一次贺国庆表演中出现了5个女性皮影,男性皮影出现的数量比女性皮影的4倍多3个,男性皮影出现了( ）个。\",\"ocr_text\":\"7.皮影戏是我国民间古老的传统艺术,在一次贺国庆表演中出现了5个女性皮影,男性皮影出现的数量比女性皮影的4倍多3个,男性皮影出现了(）个。\",\"answer\":\"23\",\"is_origin\":true,\"can_llm_solved\":true,\"markdown_gray_publish\":true,\"has_hint\":true,\"detection_type\":2,\"search_type\":1,\"analysis\":\"## 分析\\n这是一道“\\u003cwiki wiki_id=6806545505154363987 search_id=1821746597342315\\u003e倍数\\u003c/wiki\\u003e应用题”。需要用到\\u003cwiki wiki_id=8535897573364019795 search_id=1821746597342315\\u003e倍数关系\\u003c/wiki\\u003e和加法运算的知识，先求出女性皮影数量的4倍，再加上多出的3个就是男性皮影的数量。\\n\\n## 详解\\n![img](https://p6-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/9842664e6c0d44e48fb76202b714a2e3~tplv-ii0cwwkcx9-resize-crop-v1:0:0:670:278:670:278.png?lk3s=2e202201\\u0026x-expires=2052712951\\u0026x-signature=ZnzFcFdAiY9u6bkPEokahNeL9Yk%3D)\\n1. **计算女性皮影数量的4倍**：\\n已知有5个女性皮影，那么女性皮影数量的4倍为：\\n\\\\[5\\\\times4 = 20\\\\]\\n2. **计算男性皮影的数量**：\\n男性皮影数量比女性皮影的4倍多3个，所以男性皮影的数量为：\\n\\\\[20+3 = 23\\\\]\\n\\n## 总结\\n男性皮影出现了23个。\",\"has_guide_qa_entrance\":true},\"entrance_type\":8}}",
        "{\"biz_app_id\":520947,\"biz_scenes\":6,\"qa_biz_params\":{\"search_id\":1821746588933148,\"res_id\":1821746597342331,\"item_id\":255897854,\"department\":1,\"subject\":2,\"qa_item_result\":{\"search_id\":1821746588933148,\"res_id\":1821746597342331,\"item_id\":255897854,\"rich_text\":\"一个三位数,十位上的数字是个位上数字的4倍,百位上的数字是最大的一位数,这个三位数是( )。\",\"ocr_text\":\"8.一个三位数,十位上的数字是个位上数字的4倍,百位上的数字是最大的一位数,这个三位数是(）。\",\"answer\":\"941或982\",\"is_origin\":true,\"can_llm_solved\":true,\"markdown_gray_publish\":true,\"has_hint\":true,\"detection_type\":2,\"search_type\":1,\"analysis\":\"## 分析\\n先确定百位数字，再根据十位与个位数字的\\u003cwiki wiki_id=8535897573364019795 search_id=1821746597342331\\u003e倍数关系\\u003c/wiki\\u003e求出可能的十位和个位数字\\u003cwiki wiki_id=5653236463553819219 search_id=1821746597342331\\u003e组合\\u003c/wiki\\u003e，从而得到这个三位数。\\n## 详解\\n1. **确定百位数字**\\n因为最大的一位数是9，题目中说百位上的数字是最大的一位数，所以百位数字是9。\\n2. **分析十位和个位数字的关系**\\n已知十位上的数字是个位上数字的4倍。因为一个\\u003cwiki wiki_id=7382921978311934803 search_id=1821746597342331\\u003e数位\\u003c/wiki\\u003e上的数字最大是9，而十位数字是个位数字的4倍，所以十位数字最大只能是8（如果是9就不符合\\u003cwiki wiki_id=6806545505154363987 search_id=1821746597342331\\u003e倍数\\u003c/wiki\\u003e关系了）。\\n3. **求出可能的组合**\\n当十位数字是8时，因为十位数字是个位数字的4倍，所以个位数字是\\\\(8÷4 = 2\\\\)，此时这个三位数是982。\\n当十位数字是4时，因为十位数字是个位数字的4倍，所以个位数字是\\\\(4÷4 = 1\\\\)，此时这个三位数是941。\\n## 总结\\n故这个三位数是941或982。\",\"has_guide_qa_entrance\":true},\"entrance_type\":8}}",
        "{\"biz_app_id\":520947,\"biz_scenes\":6,\"qa_biz_params\":{\"search_id\":1821746588932156,\"res_id\":1821746597342299,\"item_id\":723805991,\"department\":1,\"subject\":2,\"qa_item_result\":{\"search_id\":1821746588932156,\"res_id\":1821746597342299,\"item_id\":723805991,\"rich_text\":\"新星超市今天有6人使用人工结账,有38人使用自助收银机结账,再有( )人使用自助收银机,使用自助收银机的人数就是使用人工结账的9倍。\",\"ocr_text\":\"6.新星超市今天有6人使用人工结账,有38人使用自助收银机结账,再有()人使用自助收银机,使用自助收银机的人数就是使用人工结账的9倍。\",\"answer\":\"16\",\"is_origin\":true,\"can_llm_solved\":true,\"markdown_gray_publish\":true,\"has_hint\":true,\"detection_type\":2,\"search_type\":1,\"analysis\":\"## 分析\\n这是一道“\\u003cwiki wiki_id=6806545505154363987 search_id=1821746597342299\\u003e倍数\\u003c/wiki\\u003e应用题”。需要先求出人工结账人数的9倍是多少，再用这个结果减去已使用自助收银机结账的人数，就能得到还需要的人数。\\n\\n## 详解\\n1. **计算人工结账人数的9倍**：\\n已知有6人使用人工结账，那么人工结账人数的9倍为：\\n\\\\[6\\\\times9 = 54~(\\\\text{人})\\\\]\\n2. **计算还需要使用自助收银机的人数**：\\n已经有38人使用自助收银机结账，要使使用自助收银机的人数是使用人工结账的9倍，还需要的人数为：\\n\\\\[54 - 38 = 16~(\\\\text{人})\\\\]\\n\\n## 总结\\n答案是16人。\",\"has_guide_qa_entrance\":true},\"entrance_type\":8}}",
        "{\"biz_app_id\":520947,\"biz_scenes\":6,\"qa_biz_params\":{\"search_id\":1821746613992564,\"res_id\":1821746613993524,\"item_id\":151416542,\"department\":1,\"subject\":2,\"qa_item_result\":{\"search_id\":1821746613992564,\"res_id\":1821746613993524,\"item_id\":151416542,\"rich_text\":\"小兔摘了36个果子，小猪摘的个数和小兔同样多，小猴摘了17个，它们一共摘了多少个果子？\",\"ocr_text\":\"3.小兔摘了36个桃子,小猪摘的个数和小兔同样多,小猴摘了 17 个。它们一共摘了多少个桃子？\",\"answer\":\"$36+36+17=89$(个) \\n答：它们一共摘了89个果子。\",\"is_origin\":true,\"can_llm_solved\":false,\"markdown_gray_publish\":true,\"has_hint\":true,\"detection_type\":2,\"search_type\":1,\"analysis\":\"## 分析\\n这是一道加法应用题。解题思路是先确定小猪摘的果子数，再将小兔、小猪和小猴摘的果子数相加，得到总共摘的果子数。\\n\\n## 详解\\n![img](https://p9-hippo-sign.byteimg.com/tos-cn-i-a9yeduch1e/fd06b6d70ec24470b6ca49501d56173d~tplv-ii0cwwkcx9-resize-crop-v1:0:0:670:170:670:170.png?lk3s=2e202201\\u0026x-expires=2052712978\\u0026x-signature=aoOoNgf4CUqJWXNG39d1Lk1qGdI%3D)\\n1. **确定小猪摘的果子数**：\\n已知小猪摘的个数和小兔同样多，小兔摘了36个果子，所以小猪也摘了36个果子。\\n2. **计算它们一共摘的果子数**：\\n小兔摘了36个果子，小猪摘了36个果子，小猴摘了17个果子，那么它们一共摘的果子数为三者所摘果子数相加，即：\\n\\\\[36+36+17 = 89~(\\\\text{个})\\\\]\\n\\n## 总结\\n它们一共摘了89个果子。\",\"has_guide_qa_entrance\":true},\"entrance_type\":8}}"
    ]
    json_dict = [json.loads(saw2) for saw2 in json_list]

    result_dict = collection.insert_many(json_dict)
    print(f"成功插入 {len(result_dict.inserted_ids)} 条数据。")


if __name__ == '__main__':
    add_mango()  #
    # de_weigh_json() #
